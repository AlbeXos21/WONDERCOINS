"use strict";var catalog_row_fields={ar_rows:[],caller:null,draw_item:function(e){function t(){this.removeEventListener("load",t,!1);const e=this,n=this.hires;setTimeout(function(){e.src=n},1600)}const n=this,a=e.term_table,_=new DocumentFragment;switch(a){case"types":if(e.children&&e.children.length>0){const t=common.create_dom_element({element_type:"div",class_name:"term_line",parent:_});n.node_factory(e,"term",t,"span",null),n.node_factory(e,"ref_type_material",t,null,null),n.node_factory(e,"ref_type_denomination",t,null,null),n.node_factory(e,"ref_type_averages_weight",t,null,null),n.node_factory(e,"ref_type_total_weight_items",t,null,null),n.node_factory(e,"ref_type_averages_diameter",t,null,null),n.node_factory(e,"ref_type_total_diameter_items",t,null,null)}else{const a=common.create_dom_element({element_type:"div",class_name:"type_container",parent:_}),r=common.create_dom_element({element_type:"div",class_name:"type_info",parent:a});n.node_factory(e,"term",r,"span",null);const l=e.parent?e.parent[0]:null,o=e.add_denomination?e.add_denomination:null,s=n.ar_rows.find(e=>e.section_id==l);(o||s&&"types"!==s.term_table)&&(n.node_factory(e,"ref_type_material",r,null,null),n.node_factory(e,"ref_type_denomination",r,null,null)),n.node_factory(e,"ref_type_averages_weight",r,null,null),n.node_factory(e,"ref_type_total_weight_items",r,null,null),n.node_factory(e,"ref_type_averages_diameter",r,null,null),n.node_factory(e,"ref_type_total_diameter_items",r,null,null);const i=common.create_dom_element({element_type:"div",class_name:"descriptions",parent:r});n.node_factory(e,"ref_type_design_obverse",i,null,null),n.node_factory(e,"ref_type_symbol_obverse",i,null,null);const m=common.create_dom_element({element_type:"div",class_name:"legend_obverse",parent:i});e.ref_type_legend_obverse&&m.appendChild(page.render_legend({value:e.ref_type_legend_obverse,style:"small legend_obverse_box"})),n.node_factory(e,"ref_type_legend_transcription_obverse",m,null,null),n.node_factory(e,"ref_type_design_reverse",i,null,null),n.node_factory(e,"ref_type_symbol_reverse",i,null,null);const c=common.create_dom_element({element_type:"div",class_name:"legend_reverse",parent:i});e.ref_type_legend_reverse&&c.appendChild(page.render_legend({value:e.ref_type_legend_reverse,style:"small legend_obverse_box"})),n.node_factory(e,"ref_type_legend_transcription_reverse",c,null,null),n.node_factory(e,"ref_type_equivalents",a,null,null);const d=e.ref_mint_number?e.ref_mint_number+"/":"",p=e.term.split(", "),y=p[0],g=e.ref_type_averages_diameter?Math.round(e.ref_type_averages_diameter,0):15,f=common.create_dom_element({element_type:"div",class_name:"coins_images_container",parent:a}),u=common.create_dom_element({element_type:"div",class_name:"coins_images",parent:f});u.style.width=4*g+"mm";let h=e.ref_coins_image_obverse_thumb.replace(".jpg",".png"),v=e.ref_coins_image_reverse_thumb.replace(".jpg",".png");catalog_row_fields.cargarImagen(e.term_section_id).then(function(n){if(n&&"/dedalo/media/image/1.5MB/20000/rsc29_rsc170_20917.jpg"!==n.image_obverse&&null!=n.image_obverse){const a=common.create_dom_element({element_type:"a",class_name:"image_link",href:"https://wondercoins.uca.es"+n.image_obverse,parent:u}),_=common.create_dom_element({element_type:"img",class_name:"image_obverse",src:"https://wondercoins.uca.es"+n.image_obverse,title:e.section_id,dataset:{caption:page_globals.OWN_CATALOG_ACRONYM+" "+d+y},parent:a});_.style.width="50mm",_.hires="https://wondercoins.uca.es"+n.image_obverse,_.loading="lazy",_.addEventListener("load",t,!1);const r=common.create_dom_element({element_type:"a",class_name:"image_link",href:"https://wondercoins.uca.es"+n.image_reverse,parent:u}),l=common.create_dom_element({element_type:"img",class_name:"image_reverse",src:"https://wondercoins.uca.es"+n.image_reverse,title:e.section_id,parent:r});l.style.width="50mm",l.hires="https://wondercoins.uca.es"+n.image_reverse,l.loading="lazy",l.addEventListener("load",t,!1)}else{const n=common.create_dom_element({element_type:"a",class_name:"image_link",href:h,parent:u}),a=common.create_dom_element({element_type:"img",class_name:"image_obverse",src:h,title:e.section_id,dataset:{caption:page_globals.OWN_CATALOG_ACRONYM+" "+d+y},parent:n});a.style.width="50mm",a.hires=h,a.loading="lazy",a.addEventListener("load",t,!1);const _=common.create_dom_element({element_type:"a",class_name:"image_link",href:v,parent:u}),r=common.create_dom_element({element_type:"img",class_name:"image_reverse",src:v,title:e.section_id,parent:_});r.style.width="50mm",r.hires=v,r.loading="lazy",r.addEventListener("load",t,!1)}}),window.matchMedia&&window.matchMedia("print").addListener(function(e){e.matches&&(u.style.width="50mm",img_obverse.style.width="40mm",img_reverse.style.width=1*g+"mm"),e.matches||(u.style.width="50mm",img_obverse.style.width="40mm",img_reverse.style.width="40mm")});const b=common.create_dom_element({element_type:"div",class_name:"collection_auction",parent:a});n.node_factory(e,"ref_coins_collection",b,null,null),n.node_factory(e,"ref_coins_auction",b,null,null)}break;case"mints":if(common.create_dom_element({element_type:"div",class_name:"mint",text_content:e.term,parent:_}),e.term_section_id){common.create_dom_element({element_type:"a",class_name:"link link_mint",href:page_globals.__WEB_ROOT_WEB__+"/mint/"+e.term_section_id,target:"_blank",parent:_})}break;default:common.create_dom_element({element_type:"div",class_name:a+"_value",text_content:e.term,parent:_})}const r=common.create_dom_element({element_type:"div",class_name:"row_node "+a});return r.appendChild(_),r},node_factory:function(e,t,n,a,_){if(e[t]){const r=a||"span",l=_||t;let o;switch(t){case"ref_type_total_weight_items":case"ref_type_total_diameter_items":o="("+e[t]+")";break;case"ref_type_averages_weight":o=page.render_weight_value(e);break;case"ref_type_averages_diameter":o=page.render_diameter_value(e);break;case"ref_type_equivalents":o=e[t].replace(/ \| /g," "),o=o.replace(/<br>/g," | ");break;case"term":o=page.render_type_label(e);break;default:o=e[t]}const s=common.create_dom_element({element_type:r,class_name:l,inner_html:o,parent:n});return s.title=e.section_id,!0}return!1},load_type_coins:function(e){const t=data_manager.request({body:{dedalo_get:"records",table:"types",ar_fields:["*"],lang:page_globals.WEB_CURRENT_LANG_CODE,limit:0,count:!1,sql_filter:"section_id="+e,resolve_portals_custom:{bibliography_data:"bibliographic_references",ref_coins_union:"coins",coin_references:"coins","coins.bibliography_data":"bibliographic_references",ref_coins_findspots_data:"findspots","findspots.bibliography_data":"bibliographic_references",ref_coins_hoard_data:"hoards","hoards.bibliography_data":"bibliographic_references",denomination_data:"denomination",material_data:"material",related_types_data:"types",mint_data:"mints"}}});return t},cargarImagen:async function(e){let t;try{const n=await catalog_row_fields.load_type_coins(e);n.result&&n.result.length>0&&n.result[0].coin_references&&n.result[0].coin_references.length>0&&(t=n.result[0].coin_references[0],console.log("imageObverse asignada:",t))}catch(e){console.error("Error al cargar la imagen:",e)}return t}};