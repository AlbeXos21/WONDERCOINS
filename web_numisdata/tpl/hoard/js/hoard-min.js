"use strict";var hoard={section_id:null,export_data_container:null,row_detail_container:null,search_options:{},map:null,table:null,set_up:function(options){const self=this;return self.export_data_container=options.export_data_container,self.row_detail_container=options.row_detail_container,self.section_id=options.section_id,self.table=options.table,self.section_id?self.get_row_data({section_id:options.section_id}).then((function(ar_rows){if(console.log("[set_up->get_row_data] ar_rows:",ar_rows),ar_rows&&ar_rows.length>0){self.row=ar_rows[0];const hoard_node=render_hoard.draw_hoard({row:self.row}),container=self.row_detail_container;for(;container.hasChildNodes();)container.removeChild(container.lastChild);container.appendChild(hoard_node);const map_fact=new map_factory;let resultado={hallazgos:{datos:[]},cecas:{datos:[]},complejos:{datos:[]}};resultado.hallazgos.datos.push(ar_rows[0]),console.log("source_maps: ",ar_rows[0]);const unico=!0,map=map_fact.init({map_container:map_container,map_position:ar_rows[0].map,source_maps:page.maps_config.source_maps,result:resultado,findspot:!0,unique:!0}),rows_container=document.getElementById("rows_container");self.get_types_data(self.row,rows_container)}else self.row_detail.innerHTML="Sorry. Empty result for section_id: "+self.section_id})):self.row_detail.innerHTML="Error. Invalid section_id",!0},get_row_data:async function(options){const self=this,section_id=options.section_id,ar_fields=["*"],sql_filter="section_id="+parseInt(section_id),table="findspots"===this.table?"findspots":"hoards";return data_manager.request({body:{dedalo_get:"records",db_name:page_globals.WEB_DB,lang:page_globals.WEB_CURRENT_LANG_CODE,table:table,ar_fields:ar_fields,sql_filter:sql_filter,limit:1,count:!1,offset:0,resolve_portals_custom:{coins_data:"coins",bibliography_data:"bibliographic_references"}}}).then((function(api_response){if(!api_response.result)return console.warn("Empty result:",api_response),null;const ar_rows=page.parse_hoard_data(api_response.result);return ar_rows}))},get_types_data:function(row,rows_container){const term_id="hoards"===row.table?"numisdata5_"+row.section_id:"numisdata279_"+row.section_id,selected_element_term_id=term_id,global_data_item_coins_list=row.coins,global_data_item_types_list=row.types;return!0}};