"use strict";var main_home={form:null,image_wrapper:null,form_container:null,ar_images:[],set_up:function(e){const n=this;n.image_wrapper=e.image_wrapper,n.form_container=e.form_container,n.ar_images=e.ar_images||[],n.form=new form_factory,n.form_node=n.render_form();let t=document.querySelector("#menu li[role='numisdata349_58']"),o=t.querySelectorAll(".links.links_inside li a");return o.forEach((e,n)=>{let t=e.href.replace("https://wwwondercoins.uca.es/web_numisdata/","");console.log(t),e.href=t}),n.form_container.appendChild(n.form_node),n.main_coin_image(),!0},render_form:function(){const e=this,n=new DocumentFragment,t=common.create_dom_element({element_type:"div",class_name:"form-row fields",parent:n});e.form.item_factory({id:"global_search",name:"global_search",label:tstring.global_search||"global_search",q_column:"global_search",eq:"MATCH",eq_in:"",eq_out:"",class_name:"global_search",parent:t,callback:function(n){const o={id:"mint",name:"mint",class_name:"mint_form",label:tstring.mint||"mint",q_column:"p_mint",value_wrapper:['["','"]'],eq:"LIKE",eq_in:"%",eq_out:"%",is_term:!0,node_input:n.node_input,node_values:n.node_values,q_selected:n.q_selected,parent:t};e.form.activate_autocomplete({form_item:o,table:"catalog"});const a=n.node_input,r=common.create_dom_element({element_type:"div",class_name:"search_operators_info",parent:a.parentNode});let m;r.addEventListener("click",function(n){if(n.stopPropagation(),m)return m.remove(),void(m=null);m=e.form.full_text_search_operators_info(),a.parentNode.appendChild(m)}),window.addEventListener("click",function(e){m&&!a.contains(e.target)&&(m.remove(),m=null)})}});const o=common.create_dom_element({element_type:"div",class_name:"form-group field button_submit",parent:n}),a=common.create_dom_element({element_type:"input",type:"submit",id:"submit",value:tstring.search||"Search",class_name:"btn btn-light btn-block primary",parent:o});a.addEventListener("click",function(n){n.preventDefault(),e.form_submit()});const r=common.create_dom_element({element_type:"form",id:"search_form",class_name:"form-inline"});return r.appendChild(n),document.addEventListener("click",function(){const n=document.querySelector(".container_values");n.querySelector(".line_value")&&e.form_submit()}),r},form_submit:function(){const e=this,n=e.form_node;return n?new Promise(function(e){const n=document.getElementById("global_search");if(n){let t;document.querySelector(".line_value")?t=document.querySelector(".value_label").innerHTML:(t=n.value,t.leng<2&&e(!1));const o={$and:[{id:"global_search",field:"global_search",q:t,op:"="}]},a=psqo_factory.build_safe_psqo(o),r=psqo_factory.encode_psqo(a);window.location.href="./catalog/?psqo="+r,e(!0)}else e(!1)}):new Promise(function(e){console.error("Error on submit. Invalid form_node.",n),e(!1)})},main_coin_image:function(){function e(e){const o=Math.floor(Math.random()*(e.length-0))+0,a=e[o]?e[o].url:"",r=a,m="(ref_coins_image_reverse='"+r+"' OR ref_coins_image_obverse='"+r+"')",i={dedalo_get:"records",db_name:page_globals.WEB_DB,lang:page_globals.WEB_CURRENT_LANG_CODE,table:"types",ar_fields:["mint","mint_number","catalogue","number","denomination","section_id"],sql_filter:m,limit:1,count:!1,offset:0};return data_manager.request({body:i}).then(function(e){const o=e.result[0],a=o&&o.mint?o.mint+" | ":"",m=o&&o.mint_number?o.mint_number+"/":"",i=o&&o.denomination?" | "+o.denomination:"",_=o&&o.catalogue?o.catalogue:"",l=o&&o.number?o.number:"",c=a+_+" "+m+l,s=o&&o.section_id?page_globals.__WEB_ROOT_WEB__+"/type/"+o.section_id:"#",u=n.image_wrapper;u.href=s;const d=page_globals.__WEB_MEDIA_BASE_URL__+r,p=d.replace("/1.5MB/","/thumb/"),f=common.create_dom_element({element_type:"img",class_name:"main-coin-image",src:p,parent:u}),g=document.createElement("img");g.addEventListener("load",function(){f.src=d,g.remove(),common.create_dom_element({element_type:"p",class_name:"img-text",text_content:c+i,parent:u})}),g.src=d,t.remove()})}const n=this,t=common.create_dom_element({element_type:"div",class_name:"spinner",parent:n.image_wrapper});return e(n.ar_images),!0}};