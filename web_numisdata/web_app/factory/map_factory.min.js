"use strict";function map_factory(){this.map_container=[],this.map_position=null,this.source_maps=[],this.map=null,this.result=null,this.init=function(options){const self=this;this.map_container=options.map_container||null,this.map_position=options.map_position||[36.5297,-6.2924],this.popup_options=options.popup_options||{},this.source_maps=options.source_maps||[],this.result=options.result||null;const containerElement="string"==typeof this.map_container?document.getElementById(this.map_container):this.map_container;if(containerElement)return this.map=L.map(containerElement).setView(this.map_position,8),this.add_layer_control(this.map,this.source_maps),L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap contributors"}).addTo(this.map),this.add_markers(this.map,this.result),this.create_legend(this.map),this.map;console.error("Contenedor del mapa no válido.")},this.add_layer_control=function(map,source_maps){if(source_maps.length>0){const baseLayers={};source_maps.forEach(layer=>{baseLayers[layer.name]=L.tileLayer(layer.url,layer.options)}),L.control.layers(baseLayers).addTo(map)}},this.add_markers=function(map,data){const markersCluster=L.markerClusterGroup({maxClusterRadius:80,iconCreateFunction:function(cluster){return L.divIcon({html:`<div class="custom-cluster">${cluster.getChildCount()}</div>`,className:"",iconSize:[40,40]})}}),iconoCeca=L.icon({iconUrl:"tpl/assets/images/map/IMG_8276.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),iconoHallazgo=L.icon({iconUrl:"tpl/assets/images/map/IMG_5962.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]});function miFuncionPersonalizada(tipo){console.log("Se hizo clic en:",tipo)}for(let index=0;index<data.hallazgos.datos.length;index++){const data_ceca=JSON.parse(data.hallazgos.datos[index].map);if(null!=data_ceca){const markerHallazgo=L.marker([data_ceca.lat,data_ceca.lon],{icon:iconoHallazgo}).bindPopup("<b>Hallazgo</b><br>Otra información.").on("click",(function(){miFuncionPersonalizada(data.hallazgos.datos[index].name),this.openPopup()}));markersCluster.addLayer(markerHallazgo)}}for(let index=0;index<data.cecas.datos.length;index++){const data_ceca=JSON.parse(data.cecas.datos[index].map);if(null!=data_ceca&&void 0!==data_ceca.lat&&void 0!==data_ceca.lon){const markerCeca=L.marker([data_ceca.lat,data_ceca.lon],{icon:iconoCeca}).bindPopup("<b>Ceca</b><br>Otra información.").on("click",(function(){miFuncionPersonalizada(data.cecas.datos[index].name),this.openPopup()}));markersCluster.addLayer(markerCeca)}}map.addLayer(markersCluster)},this.create_legend=function(map){L.control.Legend({position:"bottomleft",collapsed:!1,title:"Leyenda",columns:2,legends:[{label:"Ceca",type:"image",url:"tpl/assets/images/map/IMG_8276.png"},{label:"Hallazgo",type:"image",url:"tpl/assets/images/map/IMG_5962.png"},{label:"Complejo",type:"image",url:"tpl/assets/images/map/orange.png"}]}).addTo(map)}}